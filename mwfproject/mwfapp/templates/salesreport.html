{% extends "base.html" %}
{% load humanize %}

{% block title %}Sales Report{% endblock %}

{% block content %}


<!-- Search & Add Sale -->
<div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-8 mt-6">
  <h1 class="text-3xl font-bold mb-6 text-[#643310]">Sales Report</h1>
  <div class="flex justify-end items-center mb-4 gap-3">
  <input type="text" id="salesSearch" placeholder="Search..."
         class="border-2 border-[#643310] rounded-md px-4 py-2 focus:outline-none focus:ring-1 focus:ring-[#643310] shadow-sm w-64" />
  <a href="{% url 'recordSales' %}" class="bg-[#643310] text-white px-4 py-2 rounded-md hover:bg-[#50250f]">+ Add Sale</a>

</div>
<!-- Table -->
<div class="bg-white rounded-lg shadow p-4 overflow-x-auto">
  <table class="w-full border-collapse">
    <thead>
      <tr class="bg-gray-200 text-lg font-bold text-left">
        <th class="px-4 py-2">Date</th>
        <th class="px-4 py-2">Item</th>
        <th class="px-4 py-2">Quantity</th>
        <th class="px-4 py-2">Amount</th>
      </tr>
    </thead>
    <tbody>
      {% for sale in page_obj %}
      <tr class="border-b text-lg hover:bg-[#f9ece5]">
        <td class="px-4 py-2">{{ sale.date }}</td>
        <td class="px-4 py-2">{{ sale.stock_item.name }}</td>
        <td class="px-7 py-2">{{ sale.quantity_sold }}</td>
        <td class="px-4 py-2">{{ sale.total_price|intcomma }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4" class="p-4 text-center text-gray-500">No sales data available</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- Pagination -->
<div class="mt-4 flex justify-end space-x-2">
  {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}" class="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300">&laquo; Previous</a>
  {% endif %}

  {% for num in page_obj.paginator.page_range %}
    {% if page_obj.number == num %}
      <span class="px-3 py-1 bg-gray-500 text-white rounded">{{ num }}</span>
    {% else %}
      <a href="?page={{ num }}" class="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300">{{ num }}</a>
    {% endif %}
  {% endfor %}

  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}" class="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300">Next &raquo;</a>
  {% endif %}
</div>

<script>
const searchInput = document.getElementById('salesSearch');
const tableRows = document.querySelectorAll('table tbody tr');

searchInput.addEventListener('input', function() {
  const filter = searchInput.value.toLowerCase();
  tableRows.forEach(row => {
    row.style.display = row.textContent.toLowerCase().includes(filter) ? '' : 'none';
  });
});
</script>
{% endblock %}
